#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running pre-push checks..."

# 1. Build test
echo "ğŸ“¦ Testing build..."
npm run build || {
    echo "âŒ Build failed! Please fix errors before pushing."
    echo "ğŸ’¡ Tip: Check for missing imports, TypeScript errors, or platform-specific dependencies."
    exit 1
}

# 2. TypeScript check (if script exists)
if npm run typecheck --dry-run >/dev/null 2>&1; then
    echo "ğŸ” Checking TypeScript..."
    npm run typecheck || {
        echo "âŒ TypeScript errors found! Please fix before pushing."
        exit 1
    }
fi

# 3. Lint check (if script exists)
if npm run lint --dry-run >/dev/null 2>&1; then
    echo "ğŸ§¹ Running linter..."
    npm run lint || {
        echo "âŒ Linting errors found! Please fix before pushing."
        exit 1
    }
fi

echo "âœ… All checks passed! Pushing to remote..."